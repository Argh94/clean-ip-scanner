# 🚀 Clean IP Scanner | اسکنر آی‌پی کلین

![WebSift Logo](https://github.com/Argh94/clean-ip-scanner/blob/main/59.png)

**Clean IP Scanner** یک اسکریپت Bash است که برای اسکن و تست تاخیر (latency) آی‌پی‌های مرتبط با شبکه‌های Cloudflare، IRCF (دامنه‌های ایرانی کلودفلر) و Gcore CDN طراحی شده است. این اسکریپت روی Termux (اندروید) اجرا می‌شود و به کاربران کمک می‌کند تا آی‌پی‌هایی با پینگ کمتر و دسترس‌پذیرتر را شناسایی کنند. اسکریپت محیط کاربری رنگی و کاربرپسند دارد و نصب خودکار، هندل خطاها و پاک‌سازی فایل‌های موقت را به طور خودکار انجام می‌دهد.

---

## 🗂️ Table of Contents | فهرست مطالب

- [✨ Features | امکانات](#features--امکانات)
- [📋 Requirements | پیش‌نیازها](#requirements--پیش‌نیازها)
- [⬇️ Installation | نصب](#installation--نصب)
- [▶️ Usage | نحوه استفاده](#usage--نحوه-استفاده)
- [⚙️ How It Works | نحوه کار](#how-it-works--نحوه-کار)
- [📁 File Structure | ساختار فایل‌ها](#file-structure--ساختار-فایل‌ها)
- [🗂 Domains JSON File | فایل دامین‌ها](#domains-json-file--فایل-دامین‌ها)
- [🚨 Error Handling | مدیریت خطا](#error-handling--مدیریت-خطا)
- [🤝 Contributing | مشارکت](#contributing--مشارکت)
- [📄 License | مجوز](#license--مجوز)
- [👤 Author | نویسنده](#author--نویسنده)

---

## ✨ Features | امکانات

- **اسکن و تست پینگ آی‌پی:** اسکن و پینگ آی‌پی‌های Cloudflare، IRCF و Gcore برای شناسایی آی‌پی‌های دسترس‌پذیر و نمایش تاخیر آن‌ها.
- **رابط کاربری رنگی و دوستانه:** نمایش منوی هنری ASCII با گزینه‌های شفاف و خروجی رنگی (سبز: آی‌پی در دسترس، قرمز: غیرقابل دسترسی، آبی: تیترها).
- **نصب خودکار:** نصب پکیج‌های مورد نیاز Termux (curl, jq, dnsutils) و بروزرسانی خودکار سیستم.
- **مدیریت خطا:** شناسایی و گزارش مشکلاتی مانند دانلود ناموفق، نبود فایل یا مشکل اتصال شبکه با راهکارهای پیشنهادی (مثلاً فعال کردن VPN).
- **مرتب‌سازی بر اساس تاخیر:** مرتب‌سازی نتایج براساس کمترین پینگ برای یافتن سریع‌ترین آی‌پی‌ها.
- **پاک‌سازی و حذف:** امکان پاک‌سازی فایل‌های موقت یا حذف کامل اسکریپت و فایل‌های مرتبط.
- **مدیریت وقفه‌ها (Trap):** پاک‌سازی خودکار فایل‌های موقت در صورت قطع اسکریپت (مثلاً با Ctrl+C).
- **پشتیبانی از دامنه‌های IRCF:** دریافت آی‌پی برای دامنه‌های سفارشی IRCF از فایل domains.json به‌وسیله DNS.

---

## 📋 Requirements | پیش‌نیازها

- **Termux:** فقط روی Termux (شبیه‌ساز ترمینال اندروید) اجرا می‌شود.
- **اتصال اینترنت:** برای دانلود لیست آی‌پی‌ها و انجام جستجوی DNS نیاز است.
- **پکیج‌ها:** اسکریپت به صورت خودکار پکیج‌های زیر را نصب می‌کند:
  - `curl`: برای دانلود لیست‌ها و داده‌های API
  - `jq`: برای پردازش داده‌های JSON (Gcore و IRCF)
  - `dnsutils`: برای حل DNS دامنه‌های IRCF
- **مجوز دسترسی به حافظه:** Termux نیازمند این دسترسی برای ساخت و مدیریت فایل‌های موقت است.
- **فایل domains.json:** شامل لیست دامنه‌های IRCF (در مخزن موجود است).

---

## ⬇️ Installation | نصب

1. **نصب Termux:**
   - Termux را از [F-Droid](https://f-droid.org/) یا Google Play نصب کنید.

2. **اعطای دسترسی حافظه:**
   ```bash
   termux-setup-storage
   ```

3. **دانلود و اجرای اسکریپت:**
   ```bash
   curl -s -L https://raw.githubusercontent.com/Argh94/clean-ip-scanner/main/check_clean_ips.sh -o check_clean_ips.sh && curl -s -L https://raw.githubusercontent.com/Argh94/clean-ip-scanner/main/domains.json -o domains.json && chmod +x check_clean_ips.sh && ./check_clean_ips.sh
   ```
   - این دستور اسکریپت و domains.json را دانلود، اجرایی و اجرا می‌کند. وابستگی‌ها نیز به صورت خودکار نصب می‌شوند.

---

## ▶️ Usage | نحوه استفاده

- **اجرای اسکریپت:**
  ```bash
  ./check_clean_ips.sh
  ```
- **گزینه‌های منو:**
  1. **بررسی آی‌پی‌های Cloudflare:** دریافت رنج آی‌پی‌ها و تست پینگ اولین آی‌پی هر رنج.
  2. **بررسی آی‌پی‌های IRCF:** دریافت آی‌پی دامنه‌های موجود در domains.json و تست پینگ آن‌ها.
  3. **بررسی آی‌پی‌های Gcore:** دریافت آی‌پی‌ها از API عمومی Gcore و تست پینگ.
  4. **خروج:** پاک‌سازی فایل‌های موقت و خروج.
  5. **حذف اسکریپت:** حذف کامل اسکریپت، فایل‌های موقت و domains.json و سپس خروج.

- **خروجی:**
  - سبز: آی‌پی‌های در دسترس به همراه زمان پینگ (مثال: `Cloudflare,104.16.0.1,25.3 ms`)
  - قرمز: آی‌پی‌های غیرقابل دسترس (مثال: `Cloudflare,104.16.0.1,Unreachable`)
  - نتایج براساس تاخیر مرتب و نمایش داده می‌شوند.
  - اگر هیچ آی‌پی در دسترس نبود، پیشنهاد فعال‌سازی VPN یا تغییر ISP داده می‌شود.

---

## ⚙️ How It Works | نحوه کار

- **راه‌اندازی:** بروزرسانی پکیج‌های Termux و نصب curl, jq, dnsutils.
- **دریافت آی‌پی‌ها:**
  - **Cloudflare:** دانلود CIDRها و استخراج اولین آی‌پی هر بلاک.
  - **IRCF:** خواندن دامنه‌ها از domains.json و دریافت آی‌پی با dig و پینگ هر کدام.
  - **Gcore:** دریافت لیست آی‌پی‌ها از API Gcore.
- **تست پینگ:** هر آی‌پی ۴ بار با تایم‌اوت ۷ ثانیه پینگ می‌شود. کمترین مقدار پینگ ذخیره یا به عنوان "Unreachable" علامت‌گذاری می‌شود.
- **مرتب‌سازی و نمایش:** نتایج براساس پینگ مرتب و به صورت جدول رنگی نمایش داده می‌شوند.
- **پاک‌سازی:** فایل‌های موقت هنگام خروج یا حذف اسکریپت پاک می‌شوند.

---

## 📁 File Structure | ساختار فایل‌ها

```
├── check_clean_ips.sh  # اسکریپت اصلی
├── domains.json        # لیست دامنه‌های IRCF
└── README.md           # این مستندات
```

**فایل‌های موقت (در حین اجرا ساخته می‌شوند):**
- `/data/data/com.termux/files/usr/tmp/temp_ips.txt`: نتایج خام پینگ
- `/data/data/com.termux/files/usr/tmp/sorted_ips.txt`: نتایج مرتب‌شده
- `cloudflare_ips.txt`: رنج آی‌پی‌های Cloudflare (بعد از استفاده حذف می‌شود)

---

## 🗂 Domains JSON File | فایل دامین‌ها

`domains.json` شامل لیست دامنه‌های IRCF برای گزینه ۲ است:
```json
{
  "addresses": [
    "mci.ircf.space",
    "mtn.ircf.space",
    "mkh.ircf.space",
    "rtl.ircf.space",
    "ast.ircf.space",
    "hwb.ircf.space",
    "sht.ircf.space",
    "prs.ircf.space",
    "mbt.ircf.space",
    "ask.ircf.space",
    "rsp.ircf.space",
    "afn.ircf.space",
    "ztl.ircf.space",
    "psm.ircf.space"
  ]
}
```
- اسکریپت این دامنه‌ها را می‌خواند، آی‌پی آن‌ها را دریافت و تست می‌کند.
- این فایل باید کنار اسکریپت قرار داشته باشد.

---

## 🚨 Error Handling | مدیریت خطا

- **خطای نصب پکیج:** راهنمایی برای تغییر مخزن Termux (`termux-change-repo`) یا بررسی اینترنت.
- **مشکل شبکه:** اگر curl نتواند آی‌پی‌ها را دریافت کند، کد خطا و راه‌حل (فعال‌سازی VPN) ارائه می‌شود.
- **لیست آی‌پی خالی:** راهنمایی برای رفع مشکل شبکه.
- **عدم رزولوشن دامنه IRCF:** گزارش "عدم توانایی در دریافت آی‌پی" و ادامه فرآیند.
- **JSON نامعتبر:** گزارش خطا و ادامه به منو.
- **ورودی منوی نامعتبر:** درخواست دوباره برای انتخاب صحیح (۱ تا ۵).

---

## 🤝 Contributing | مشارکت

خوشحال می‌شوم که مشارکت کنید!
1. Fork کنید.
2. یک شاخه جدید بسازید.
3. تغییرات خود را اعمال و تست کنید.
4. Commit و Push کنید.
5. Pull Request بفرستید.

کد شما باید مطابق سبک اسکریپت و با مدیریت خطا باشد.

---

## 📄 License | مجوز

این پروژه تحت مجوز MIT ارائه شده است. (LICENSE را ببینید)

---

## 👤 Author | نویسنده

- **Argh94**
- GitHub: [https://github.com/Argh94](https://github.com/Argh94)
- برای سوال یا بازخورد issue باز کنید.

---
